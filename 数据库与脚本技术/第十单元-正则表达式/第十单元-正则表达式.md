[TOC]







# 第十单元-正则表达式



## 10.1 正则表达式  

正则表达式是用于描述字符排列和匹配模式的一种语法规则。它主要用于字符串的模式分割、匹配、查找及替换操作。

① 正则表达式就是为了处理大量的文字|文本|字符串而定义的一套规则和方法.
② 通过定义这些特殊符号的辅助,系统管理员就可以快速过滤,替换和输出需要的字符串.
③ linux正则表达式一般以行为处理单位.



创建练习环境：

```shell
[root@ mysql-master ~]# vim test.txt
I love linux.

I like badminton ball ,billiard ball and chinese chess!
my blog is http://blog.51cto.com
our site is http://www.aaa.org
my qq num is 49000448.

not 4900000448.
my god!
```



### 10.1.1 基础正则表达式

基本正则表达式（Basic Regular Expression，BRE），又称为标准正则表达式，是最早制订的正则表达式规范，仅支持最基本的元字符集。基本正则表达式是POSIX规范制订的两种正则表达式语法标准之一，另外一种语法标准称为扩展正则表达式，将在随后介绍。



**基本正则表达式元字符**

```shell
1）^word	搜索以word开头的；
2）word$	搜索以word结尾的；
3）^$	表示空行；
4）.		表示任意一个字符，字母、数字、特殊符号都匹配，不包括“空行”但包括空格；
5）\		转义符，比如“\.”就表示“.”本身，让有特殊意义的字符，脱掉马甲，还原原型；
6）*		表示重复前面0个或多个的一个字符；
7）.*		匹配所有的字符，包括空行。^.*以任意多个字符开头，.*$以任意多个字符结尾；
8）[abc]		匹配字符集合里的任意一个字符，不是匹配一个单词；
9）[^abc]	匹配不包含^后任意一个字符的内容，匹配的是一个字符，而不是不匹配一个单词；
10）a\{n,m\}  重复n到m次前一个字符。如果用egrep可以去掉“\”斜线;
a\{n,\}    	  重复至少n次，前一个重复的字符。如果用egrep/sed -r可以去掉斜线；
a\{n\}    	重复n次，前一个重复的字符。如果用egrep/sed -r可以去掉斜线；
a\{,m\}   	最多m次。??这个需要验证??

注意：egrep或sed -r过滤一般特殊字符可以不转义。
```



**1．行首定位符 ^**
是正则表达式中的定位符之一，用来匹配行首的字符，表示行首的字符是“^”后面的那个字符。正则表达式中的定位符的作用与其他的元字符不同，它们不是用来匹配具体的文本，而是匹配某个具体的位置，例如行首定位符“^”就是用来匹配文本行的开头的字符的。

```
#列出/etc目录中的以字母po开头的文件
ls /etc | grep "^po"
```



**2．行尾定位符 \$**
与行首定位符的作用恰恰相反，行尾定位符的作用是用来定位文本行的末尾的。从语法上讲，行尾定位符的位置也与行首定位符相反，行首定位符位于所作用的字符之前，而行尾定位符位于所作用的字符之后。"^$" 匹配空行.

```
ls /etc | grep "conf$"
```



**3．单个字符匹配 .**
圆点“.”用来匹配任意单个字符，包括空格，但是不包括换行符“\n”。当用户使用“.”符号后，意味着该位置一定有一个字符，无论它是什么字符。

```
ls /etc | grep "conf."
```



**4．限定符\***
星号 \* 是正则表达式中的限定符之一。限定符本身不代表任何字符，它是用来指定其前面的一个字符必须要重复出现多少次才能满足匹配。

```
ls /etc | grep "^sss*"
```



**5．字符集匹配 [ ]**
方括号“[ ]”的功能比较特殊，它是用来指定一个字符集合的，其基本语法为：

```
[abc]
```

```
#筛选所有以字符r开头，并且紧跟着1个字符c的文本行
ls /etc |grep "^rc"

#筛选所有以字符r开头，紧跟着1个字符为c，下面1个字符为单个数字的文本行
ls /etc | grep "^rc[0-9]"
```





**6．字符集不匹配 [^]**
前面已经介绍过行首定位符“^”和字符集匹配符“[ ]”。但是如果将这2个符号结合起来，则其意义会发生变化。符号“[^]”表示不匹配其中列出的任意字符，其语法如下：

```
[^abc]
```

其中a、b和c表示任意的单个字符。`[^]`符号的用法与符号`[ ]`的用法相同，不再举例说明。
除了前面介绍的6个元字符之外，在基本正则表达式中还定义了其他的一些元字符。这些元字符使用较少，语法较繁琐，且在扩展正则表达式和PERL正则表达式中都有替代的元字符，所以不再详细说明。表中列出了基本正则表达式的其他的元字符。

![20190620201013111](assets/20190620201013111.png)



**7.反斜杠字符**
\转义(escapes) 一个特殊的字符,使这个字符表示原来字面上的意思.
\$表示了原来的字面意思”$”,而不是在正则表达式中表达的匹配行尾的意思.
同样,"\\“也被解释成了字面上的意思”\".





**8.转义(escape)“尖角号”\<…\>**
用于表示单词的边界. 尖角号必须被转义,因为不这样做的话它们就表示单纯的字面意思而已."\<the\>" 匹配单词"the",但不匹配"them", “there”, “other”, 等等





### 10.1.2 扩展正则表达式

扩展正则表达式（Extended Regular Expression，ERE）支持比基本正则表达式更多的元字符，但是扩展正则表达式对有些基本正则表达式所支持的元字符并不支持。上文中介绍的元字符“^”、“$”、“.”、“*”、“[]”以及“[^]”这6个元字符在扩展正则表达式都得到了支持，并且其意义和用法都完全相同，不再重复介绍。接下来重点介绍一下在扩展正则表达式中新增加的一些元字符。



扩展正则表达式需要使用grep -E或egrep进行过滤。

```
1）+	重复一个或多个以上前面的字符；
2）?	重复0个或一个前面的字符；
3）	|	用或的方法查找多个符合的字符串，即同时过滤多个字符串；
4）()	找出“用户组”字符串，即分组过滤。
5)  {n,m}   重复n到m次前一个字符
```



**1．限定符 +**
重复一个或多个以上前面的字符

```
echo a111b | grep 'a1\+b'
echo a111b | gawk '/a1+b/'
echo a111b | sed -ne '/a1\+b/p'
这三句的效果都等同
```

#筛选以字符串“s”开头，后面至少紧跟着1个字符“s”的文本行

```
ls /etc | egrep "^ss+"
```



**2．限定符“?”**
问号“?”是另外一个限定符，它用来限定前面的字符最多只出现1次，即前面的字符可以重复0次或者1次。

```
ls /etc | egrep "^sss?"
```



**3．竖线“|”和圆括号“()”**

竖线“|” 表示多个正则表达式之间“或”的关系，其语法为：
expression1|expression2|e=xpression3|…|expressionn
圆括号“()”用来表示一组可选值的集合。竖线和圆括号经常在一起使用，表示一组可选值。

```
[root@ mysql-master ~]# ls /etc | egrep "(ssh|ssl|^yum)"
ssh
ssl
yum
yum.conf
yum.repos.d

```





**4．转义"大括号"{ }指示前面正则表达式匹配的次数.**
要转义是因为不转义的话大括号只是表示他们字面上的意思.这个用法只是技巧上的而不是基本正则表达式的内容.
“[0-9]\{5\}” 精确匹配 5 个数字 (从 0 到 9 的数字).
注意：大括号不能在“经典”(不是 POSIX 兼容)的正则表达式版本的 awk 中使用. 然而, gawk 有一个选项- -re-interval 来允许使用大括号(不必转义).
echo 2222 | gawk --re-interval '/2{3}/'







grep与egrep文本处理工具详解

grep与egrep命令应用场景

grep与egrep命令详解与举例

sed文件处理工具剖析

sed应用场景

sed工具详解

sed应用案例



